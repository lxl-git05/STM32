[toc]

# 程序配置与外设

## 1. 程序配置

### 1-1 `Systick`

​	1ms中断一次,回调函数为`HAL_SYSTICK_Callback`



## 2. 外设配置

### 2-1 OLED

#### 2-1-1 简介

* 采用江协科技OLED库(v1.2版本),进行了STM32F1标准库到STM32F4HAL库的移植

* 采用软件模拟IIC形式,节省资源

#### 2-1-2 引脚配置

| 引脚号 | 初始电平 | GPIO模式 | 上下拉 | 引脚速度 |   标签   |
| :----: | :------: | :------: | :----: | :------: | :------: |
|  PB8   |   LOW    |    PP    |   NO   |   HIGH   | OLED_SCL |
|  PB9   |   LOW    |    PP    |   NO   |   HIGH   | OLED_SDA |

#### 2-1-3 基础代码

* include

* setup:

```c
// OLED初始化
OLED_Init() ;
```

* while:

```c
// OLED刷新(必要,建议放在最后)
OLED_Update() ;
```



### 2-2 Key

#### 2-2-1 简介

* 采用江协科技Key库(编程技巧2版本),进行了简单移植
* 按键有多种模式(单击,双击,长按,按下瞬间,松开瞬间等),函数调用非常方便
* ==本代码配置了6个按键,其中有2个系统板载按键(没有加入到Key库中),还有4个接线按键,如果想要更改引脚配置,记得在函数库中修改引脚编号==

#### 2-2-2 引脚配置

|    引脚号    | GPIO模式 | 上下拉 | 标签(注意大小写) |
| :----------: | :------: | :----: | :--------------: |
|  PA-3,4,6,7  |   输入   |  上拉  |    KEY1,2,3,4    |
| PF-6,7(板载) |   输入   |  上拉  |      Key0,1      |

#### 2-2-3 基础代码

* include
* 不需要初始化
* while:

```c
if (Key_Check(KEY_1 , KEY_SINGLE))
{
    HAL_GPIO_TogglePin(LED1_GPIO_Port , LED1_Pin) ;
}
```

* 1ms定时器回调函数

```c
// 功能: 按键检测
Key_Tick() ;
```

